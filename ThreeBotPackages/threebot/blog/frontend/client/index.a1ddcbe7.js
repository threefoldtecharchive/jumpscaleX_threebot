import{S as t,i as s,s as e,N as a,p as o,q as n,r,l as p,t as l,b as i,k as c,L as m,n as g,w as u,x as h,y as d,B as f}from"./index.d504ffde.js";import{a as $}from"./app.8d939e64.js";import{d as b,b as P}from"./_api.b86b90d5.js";import"./showdown.20a62d9b.js";import{L as k}from"./ListPagination.16d97102.js";import"./Tags.67e5a0f9.js";import{P as j}from"./PostList.2f90edb3.js";function x(t){return{c:g,l:g,m:g,p:g,i:g,o:g,d:g}}function L(t){let s,e;const a=new j({props:{posts:t[10],username:t[3]}}),n=new k({props:{articlesCount:t[2],articlesPerPage:t[1].posts_per_page,objectPath:"/blog/"+t[3]+"/posts",page:t[4]}});return{c(){u(a.$$.fragment),s=o(),u(n.$$.fragment)},l(t){h(a.$$.fragment,t),s=r(t),h(n.$$.fragment,t)},m(t,o){d(a,t,o),p(t,s,o),d(n,t,o),e=!0},p(t,s){const e={};1&s&&(e.posts=t[10]),8&s&&(e.username=t[3]),a.$set(e);const o={};4&s&&(o.articlesCount=t[2]),2&s&&(o.articlesPerPage=t[1].posts_per_page),8&s&&(o.objectPath="/blog/"+t[3]+"/posts"),16&s&&(o.page=t[4]),n.$set(o)},i(t){e||(l(a.$$.fragment,t),l(n.$$.fragment,t),e=!0)},o(t){i(a.$$.fragment,t),i(n.$$.fragment,t),e=!1},d(t){f(a,t),t&&c(s),f(n,t)}}}function w(t){return{c:g,l:g,m:g,p:g,i:g,o:g,d:g}}function N(t){let s,e,m,g,u={ctx:t,current:null,token:null,pending:w,then:L,catch:x,value:10,blocks:[,,,]};return a(m=t[0],u),{c(){s=o(),e=n(),u.block.c(),this.h()},l(t){s=r(t),e=n(),u.block.l(t),this.h()},h(){document.title="Blog"},m(t,a){p(t,s,a),p(t,e,a),u.block.m(t,u.anchor=a),u.mount=(()=>e.parentNode),u.anchor=e,g=!0},p(s,[e]){if(t=s,u.ctx=t,1&e&&m!==(m=t[0])&&a(m,u));else{const s=t.slice();s[10]=u.resolved,u.block.p(s,e)}},i(t){g||(l(u.block),g=!0)},o(t){for(let t=0;t<3;t+=1){const s=u.blocks[t];i(s)}g=!1},d(t){t&&c(s),t&&c(e),u.block.d(t),u.token=null,u=null}}}async function _({host:t,path:s,params:e,query:a}){console.log("params in posts index",JSON.stringify(e));let o=parseInt(a.page);o||this.redirect(302,`${e.theuser}/posts?page=1`);let n=await b(e.theuser);o>0&&o--,console.log(n.length);let r=n.length;const p=await P(e.theuser);let l=p.posts_per_page||5,i=o*l,c=o*l+l;return{path:s,posts:n.slice(i,c),totalPostsLength:r,metadata:p}}function y(t,s,e){let a,{posts:o=[]}=s,{metadata:n}=s,{totalPostsLength:r}=s,{path:p}=s;const{preloading:l,page:i,session:c}=$();m(t,i,t=>e(7,a=t)),console.log("in posts index",a.params);let{username:g=a.params.theuser}=s,{pageNum:u=a.query.page}=s;return t.$set=(t=>{"posts"in t&&e(0,o=t.posts),"metadata"in t&&e(1,n=t.metadata),"totalPostsLength"in t&&e(2,r=t.totalPostsLength),"path"in t&&e(6,p=t.path),"username"in t&&e(3,g=t.username),"pageNum"in t&&e(4,u=t.pageNum)}),[o,n,r,g,u,i,p]}export default class extends t{constructor(t){super(),s(this,t,y,N,e,{posts:0,metadata:1,totalPostsLength:2,path:6,username:3,pageNum:4})}}export{_ as preload};
