import{S as t,i as a,s as e,L as s,p as o,q as n,r,l as p,v as l,t as m,b as u,k as i,J as c,n as g,w as h,z as d}from"./index.9569dcac.js";import{a as f}from"./app.40fc729e.js";import"./showdown.28949a86.js";import{L as $}from"./ListPagination.57aa029d.js";import"./Tags.076bca96.js";import{P}from"./PostList.3e279069.js";function b(t){return{c:g,l:g,m:g,p:g,i:g,o:g,d:g}}function L(t){var a,e,s=new P({props:{posts:t.value,username:t.username}}),n=new $({props:{articlesCount:t.totalPostsLength,articlesPerPage:t.metadata.posts_per_page,objectPath:"/blog/"+t.username+"/posts",page:t.pageNum}});return{c(){s.$$.fragment.c(),a=o(),n.$$.fragment.c()},l(t){s.$$.fragment.l(t),a=r(t),n.$$.fragment.l(t)},m(t,o){h(s,t,o),p(t,a,o),h(n,t,o),e=!0},p(t,a){var e={};t.posts&&(e.posts=a.value),t.username&&(e.username=a.username),s.$set(e);var o={};t.totalPostsLength&&(o.articlesCount=a.totalPostsLength),t.metadata&&(o.articlesPerPage=a.metadata.posts_per_page),t.username&&(o.objectPath="/blog/"+a.username+"/posts"),t.pageNum&&(o.page=a.pageNum),n.$set(o)},i(t){e||(m(s.$$.fragment,t),m(n.$$.fragment,t),e=!0)},o(t){u(s.$$.fragment,t),u(n.$$.fragment,t),e=!1},d(t){d(s,t),t&&i(a),d(n,t)}}}function j(t){return{c:g,l:g,m:g,p:g,i:g,o:g,d:g}}function k(t){var a,e,c,g;let h={ctx:t,current:null,token:null,pending:j,then:L,catch:b,value:"value",error:"null",blocks:[,,,]};return s(c=t.posts,h),{c(){a=o(),e=n(),h.block.c(),this.h()},l(t){a=r(t),e=n(),h.block.l(t),this.h()},h(){document.title="Blog"},m(t,s){p(t,a,s),p(t,e,s),h.block.m(t,h.anchor=s),h.mount=(()=>e.parentNode),h.anchor=e,g=!0},p(a,e){t=e,h.ctx=t,"posts"in a&&c!==(c=t.posts)&&s(c,h)||h.block.p(a,l(l({},t),h.resolved))},i(t){g||(m(h.block),g=!0)},o(t){for(let t=0;t<3;t+=1){const a=h.blocks[t];u(a)}g=!1},d(t){t&&(i(a),i(e)),h.block.d(t),h.token=null,h=null}}}async function N({host:t,path:a,params:e,query:s}){console.log("params in posts index",JSON.stringify(e));let o=parseInt(s.page);o||this.redirect(302,`${e.theuser}/posts?page=1`);let n=await this.fetch(`${e.theuser}/posts.json`);o>0&&o--;let r=await n.json();console.log(r.length);let p=r.length;const l=await this.fetch(`${e.theuser}/metadata.json`),m=await l.json();let u=m.posts_per_page||5,i=o*u,c=o*u+u;return{path:a,posts:r.slice(i,c),totalPostsLength:p,metadata:m}}function v(t,a,e){let s,{posts:o=[],metadata:n,totalPostsLength:r,path:p}=a;const{preloading:l,page:m,session:u}=f();c(t,m,t=>{e("$page",s=t)}),console.log("in posts index",s.params);let{username:i=s.params.theuser,pageNum:g=s.query.page}=a;return t.$set=(t=>{"posts"in t&&e("posts",o=t.posts),"metadata"in t&&e("metadata",n=t.metadata),"totalPostsLength"in t&&e("totalPostsLength",r=t.totalPostsLength),"path"in t&&e("path",p=t.path),"username"in t&&e("username",i=t.username),"pageNum"in t&&e("pageNum",g=t.pageNum)}),{posts:o,metadata:n,totalPostsLength:r,path:p,page:m,username:i,pageNum:g}}export default class extends t{constructor(t){super(),a(this,t,v,k,e,["posts","metadata","totalPostsLength","path","username","pageNum"])}}export{N as preload};
